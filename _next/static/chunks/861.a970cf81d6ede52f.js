"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[861],{58931:function(e,t,r){r.d(t,{F:function(){return o},s:function(){return s}});var a=r(85893);let o=e=>{let{text:t,onClick:r,isTight:o}=e;return o=null!=o&&o?"w-full md:w-[170px]":"md:w-[202px]",(0,a.jsx)("button",{onClick:r,className:"".concat(o," group hover:text-white normal-case flex btn bg-transparent text-center font-bold text-black border  border-black  rounded-lg h-12"),children:t})},s=e=>{let{text:t,onClick:r,isTight:o}=e;return o=null!=o&&o?"w-[98%] md:w-[120px] ":"w-[127.5px] md:w-[202px]",(0,a.jsx)("button",{onClick:r,className:"".concat(o,"  group hover:bg-white hover:text-black normal-case flex btn text-center font-bold bg-black border text-white rounded-lg h-12"),children:t})}},47861:function(e,t,r){let a;r.r(t),r.d(t,{default:function(){return x}});var o=r(85893),s=r(9367),n=r(67294),l=r(96091),i=r(58931),c=r(83977),d=r(20061);let u=(0,c.ZF)({apiKey:"AIzaSyAhJOKFbBZGLAF7kgSBXYOQNeOSfwq30B8",authDomain:"personalweb-9a157.firebaseapp.com",projectId:"personalweb-9a157",storageBucket:"personalweb-9a157.appspot.com",messagingSenderId:"535997393456",appId:"1:535997393456:web:15a8e4ffcfde94ba221bf5",measurementId:"G-4P7PPBN11C"}),h=(0,d.KL)(u),m=async()=>{if("serviceWorker"in navigator){let e=await window.navigator.serviceWorker.getRegistration("/firebase-push-notification-scope");return e||window.navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-push-notification-scope"})}throw Error("The browser doesn`t support service worker.")},p=async()=>m().then(e=>(0,d.LP)(h,{vapidKey:"BFSgOEVNbWPVgxaPQ4w1MyAigFGNz_KitopsjPXbcCqE3XjvyriHyQ1BZt2_jwygYg79TACuo8MbyU3_Qvo9VHA",serviceWorkerRegistration:e}));var f=r(69483),g=r.n(f),b=r(55678);function x(){let[e,t]=(0,n.useState)(""),[r,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[h,m]=(0,n.useState)([]),[f,x]=(0,n.useState)();(0,n.useEffect)(()=>{y()},[]),(0,n.useEffect)(()=>{w()},[]);let w=async()=>{let e=await g().getItem("fcm_token");if(null!==e){x(e);return}let t=p();if(t){g().setItem("fcm_token",t),x(t);return}},y=async()=>{await fetch("/api/socket"),(a=(0,s.ZP)()).on("newIncomingMessage",async e=>{m(t=>[...t,{author:e.author,message:e.message}]),v(e);let t=await g().getItem("fcm_token"),r=f||t;if(r){let a={to:r,priority:"high",notification:{title:"You got a new chat message",body:e.message}};fetch("https://fcm.googleapis.com/fcm/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAAfMvvKjA:APA91bG0ogWNGXOgmMK2Ffnx9C-NoiiJ3WLtiu18GW_etu5CM9UYz9jJT0TBYKE1i0nv2_0Eg9pE_Zt8aaUoN5ENrYXmzHxUt2KIzfCo7b85SqRY8-ikQyA3ceZQtyOfaWP7DN9a103F"},body:JSON.stringify(a)})}})},v=e=>{(0,b.Am)(e.author+": "+e.message,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},j=async()=>{a.emit("createdMessage",{author:r,message:d}),m(e=>[...e,{author:r,message:d}]),u("")},k=e=>{13===e.keyCode&&d&&j()};return(0,o.jsx)(l.Z,{title:"Chat Room",children:(0,o.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4 mx-auto",children:(0,o.jsx)("main",{className:"flex flex-col items-center justify-center w-full h-full gap-4",children:r?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{className:"text-xl font-bold text-black",children:["Your username: ",e]}),(0,o.jsxs)("div",{className:"flex flex-col justify-end border-t-2 bg-white h-[20rem] min-w-[33%] rounded-md shadow-md ",children:[(0,o.jsx)("div",{className:"h-full overflow-y-scroll last:border-b-0",children:h.map((e,t)=>(0,o.jsxs)("div",{className:"w-full px-2 py-1 border-b border-gray-200",children:[e.author," : ",e.message]},t))}),(0,o.jsxs)("div",{className:"flex w-full border-t border-gray-300 rounded-bl-md",children:[(0,o.jsx)("input",{type:"text",placeholder:"New message...",value:d,className:"flex-1 px-2 py-2 outline-none rounded-bl-md",onChange:e=>u(e.target.value),onKeyUp:k}),(0,o.jsx)("div",{className:"flex items-center justify-center transition-all border-l border-gray-300 rounded-br-md group hover:bg-purple-500",children:(0,o.jsx)("button",{className:"h-full px-3 group-hover:text-white",onClick:()=>{j()},children:"Send"})})]}),(0,o.jsx)(b.Ix,{})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-black",children:"How people should call you?"}),(0,o.jsx)("input",{type:"text",placeholder:"Enter your name",value:e,className:"text-gray-700 bg-gray-100 border-black input input-bordered",onChange:e=>t(e.target.value)}),(0,o.jsx)(i.s,{onClick:()=>{c(e)},text:"Go!"})]})})})})}r(64213)}}]);